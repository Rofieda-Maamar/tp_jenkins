plugins {
    id 'java'
    id 'application'
    id 'maven-publish'        // <-- needed for `publish`
}

group = 'com.example'
version = '1.0-SNAPSHOT'

// read from -P properties first, then environment variables (supports different names)
def mavenUrl = project.findProperty('maven.url') ?: System.getenv('maven.url') ?: System.getenv('MAVEN_URL') ?: System.getenv('url') ?: ''
def mavenUsername = project.findProperty('maven.username') ?: System.getenv('maven.username') ?: System.getenv('MAVEN_USERNAME') ?: System.getenv('username') ?: ''
def mavenPassword = project.findProperty('maven.password') ?: System.getenv('maven.password') ?: System.getenv('MAVEN_PASSWORD') ?: System.getenv('password') ?: ''

repositories {
    mavenCentral()

    if (mavenUrl) {
        maven {
            url = uri(mavenUrl)
            if (mavenUsername || mavenPassword) {
                credentials {
                    username = mavenUsername
                    password = mavenPassword
                }
            }
        }
    }
}



application {
    mainClass = 'com.example.Main'
}

test {
    useJUnit()
}

// Configure publishing (adjust coordinates/artifact as needed)
publishing {
    publications {
        mavenJava(MavenPublication) {
            from components.java
            groupId = project.group
            artifactId = project.name
            version = project.version
        }
    }
    repositories {
        if (mavenUrl) {
            maven {
                url = uri(mavenUrl)
                credentials {
                    username = mavenUsername
                    password = mavenPassword
                }
            }
        }
    }
}
